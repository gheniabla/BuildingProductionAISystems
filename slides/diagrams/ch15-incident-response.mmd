flowchart TB
    subgraph classification ["INCIDENT CLASSIFICATION"]
        direction TB
        sev1["SEV1 - Critical<br/>Complete service outage<br/>Data breach or security incident<br/>Over 50% of requests failing<br/>Response: Immediate, all-hands"]
        sev2["SEV2 - High<br/>Significant quality degradation over 20% drop<br/>Major feature broken<br/>Cost spike over 200% normal<br/>Response: Within 1 hour, primary team"]
        sev3["SEV3 - Medium<br/>Minor quality issues<br/>Elevated latency<br/>Partial feature degradation<br/>Response: Within 4 hours, business hours"]
        sev4["SEV4 - Low<br/>Cosmetic issues<br/>Non-critical bugs<br/>Response: Next business day"]
    end

    trigger["TRIGGER: Quality score drops<br/>over 15% for over 10 minutes"]

    step1["Step 1: ASSESS — 0-5 min<br/>Check quality dashboard for affected dimensions<br/>Identify if degradation is global or segment-specific<br/>Review recent deployments, last 24h<br/>Check external dependencies like OpenAI status"]
    step2["Step 2: MITIGATE — 5-15 min<br/>If recent deployment: Rollback<br/>If external dependency: Switch to fallback model<br/>Enable degraded mode, cached responses<br/>If rate limiting: Scale up workers<br/>Enable request shedding for non-critical traffic"]
    step3["Step 3: COMMUNICATE — 15-30 min<br/>Update status page<br/>Notify affected customers if user-facing<br/>Post in #incidents Slack channel<br/>Page additional responders if needed"]
    step4["Step 4: RESOLVE — 30+ min<br/>Identify root cause<br/>Implement fix with proper testing<br/>Deploy fix through normal pipeline<br/>Verify quality scores recovered<br/>Update status page: resolved"]
    step5["Step 5: POST-MORTEM — 24-48h<br/>Schedule blameless post-mortem<br/>Document timeline and actions<br/>Identify what worked and what did not<br/>Define action items to prevent recurrence<br/>Add regression test cases<br/>Update runbooks if needed"]

    classification --> trigger
    trigger --> step1 --> step2 --> step3 --> step4 --> step5

    classDef client fill:#3B82F6,stroke:#1D4ED8,color:#FFFFFF
    classDef gateway fill:#EF4444,stroke:#B91C1C,color:#FFFFFF
    classDef service fill:#4F46E5,stroke:#3730A3,color:#FFFFFF
    classDef data fill:#10B981,stroke:#047857,color:#FFFFFF
    classDef external fill:#F59E0B,stroke:#D97706,color:#FFFFFF
    classDef observability fill:#8B5CF6,stroke:#6D28D9,color:#FFFFFF

    class sev1 gateway
    class sev2 external
    class sev3 service
    class sev4 data
    class trigger gateway
    class step1 client
    class step2 service
    class step3 external
    class step4 observability
    class step5 data
